Как на самом деле работает SELECT

Шаг 1. (Синтаксический анализ)
Правильно ли сформулирован запрос?

Шаг 2. (Преобразование в каноническую форму)
Приведение к СКНФ / СДНФ, замена выражений (x AND NOT x) на "FALSE". 
Проверка ограничений (поле только > 18, а запрос ищет < 15). 
Оптимизатор исправит это

Шаг 3. (Генерация планов выполнения запроса и выбор оптимального плана)
Генерируется множество возможных планов, и из них выбирается с минимальной
стоимостью выполнения операций

При следующем выполнении запроса с большой вероятностью без доп. вычислений 
выберется предыдущий успешный план

Шаг 4. (Выполнение плана запроса)

Индексы.
Кластеризованные
Определяют строгий порядок записи кортежей на диске друг под другом по id.
Зависит от того, какое поле выбрано. По умолчанию Primary key является им

Некластеризованный (куча). Все разбросано по диску, но проиндексировано

+
Уникальный индекс- UNIQUE
Индекс с включенными столбцами - кроме ключевых столбцов индекс содержит неключевые
Индексированные представления - результат запроса хранится, всегда доступен,
  и тоже индексируется
Полнотекстовый - обеспечивает эффективную поддержку сложных операций поиска
  слов в символьных строках данных
Пространственный - geometry
Фильтруемый - использует придикат фильтра для индексирования ЧАСТИ строк в таблице.
  Basically, оптимизация
XML

Для выбора индексирования нужно обратить внимание на:
1) Характеристика БД
2) Выполняемые над БД операции
3) Характеристика столбцов

5) Оптимальное расположение для хранения индекса 
  (в случае независимых жестких дисков)
6) Секционированиие (в данном курсе не будет использоваться)

Не всегда хорошо индексировать маленькие таблицы. Иногда проще не делать запросы к
оптимизатору
Некластеризированные индексы следует создать для всех столбцов, часть используемых
в предикатах и условиях соединения в запросах

Покрывающий иендекс - данные для удовлетворения требований запроса присутствуют
в индексе

При выполнении задания можно посмотреть план выполнения запроса и оценить
его время выполнения.

Оптимизатор работает с определенного количества записей в таблице

Индекс с параметром hint - потребовать у оптимизатора работать с индексом

Index Tuning Wizard
  Протоколирование всех запросов за промежуток времени. Насколько эффективно
  работали некоторые конструкции. Удачно ли применение индекса или нет.
  Набор рекомендаций

Транзакции - последовательность операторов
Либо выполнилась, либо БД возвращается в состояние до транзакции
Всё или ничего.
Свойства:
(А) Атомарность. Либо выполняется вся, либо вся не выполняется
(С) Согласованность. Переводит БД из одного согласованного (целого) состояния в другое
(И) Изоляция. Транзакции разных пользователей не должны мешать друг другу
(Д) Долговечность. Если транзакция выполнена, то результаты её работы должны
сохраняться в БД, даже если в следующий момент произойдет сбой системы

Транзакция начинается с присоединения пользователя к СУБД до:
1) COMMIT WORK (зафиксировать)
2) ROLLBACK WORK (откатить)
3) отсоединение пользователя
4) сбой в работе

(С) определяется наличием согласованности БД
Ограничение целостности

Реакция системы на попытку нарушения целостности:
1. Отказ выполнить незаконную операцию
2. Выполнение компенсирующих действий 









